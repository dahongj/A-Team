{% extends 'base.html' %}

{% block title %}
<title>Todo List Manage -  A-Team skt</title>
{% endblock title %}

{% block content %}
<div class="container" >
</br>
{% if messages %}
	{% for message in messages %}
		<div class="alert">
			{{ message }}
			<span button type ="button" class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>
			<!--<button type="button" class="close" data-dismiss="alert" aria-label="Close">-->
			</button>
		</div>
	{% endfor %}
{% endif %}

	<form method="get" action="">
    <label for="filter">Filter:</label>
    <select name="filter" id="filter" onchange="this.form.submit()">

        <option value="all" {% if request.GET.filter == "all" %}selected{% endif %}>All</option>
        <option value="completed" {% if request.GET.filter == "completed" %}selected{% endif %}>Completed</option>
        <option value="incomplete" {% if request.GET.filter == "incomplete" %}selected{% endif %}>Incomplete</option>
        <option value="due_date" {% if request.GET.filter == "due_date" %}selected{% endif %}>Due Date</option>
        <option value="priority" {% if request.GET.filter == "priority" %}selected{% endif %}>Priority</option>
    </select>
</form>

<p align="right">
	<a class="btn btn-info btn-lg mt-3 px-4 rounded-pill float-end" href="{% url 'add_task' %}">
  <i class="bi bi-plus-lg"></i> Add Task
	</a>
</p>

<br>


<table class="table table-bordered text-center">
  <thead class="thead-dark">
    <tr class="row">
      <th class="col-5">Task</th>
	  <th class="col-2">Deadline</th>
		<th class="col-1">Priority</th>
      <th class="col-2">Done</th>
      <th class="col-1">Edit</th>
      <th class="col-1">Delete</th>
    </tr>
  </thead>
  <tbody>

{% if all_tasks %}
    {% for obj in all_tasks %}
       {% if selected_filter == 'completed' %}
           {% if obj.done %}
                <tr class="row">
					<td class="col-5"><del>{{ obj.task }}</del></td>
                    <td class="col-2">{{ obj.deadline }}</td>
                    <td class="col-1">{{ obj.importance }}</td>
                    <td class="col-2">
                        <a href="{% url 'pending_task' obj.id %}">
                            <button type="button" class="btn btn-dark">Mark this Pending</button>
                        </a>
                    </td>
                    <td class="col-1"><a href="{% url 'edit_task' obj.id %}"><button type="button" class="btn btn-warning">Edit</button></a></td>
                    <td class="col-1"><a href="{% url 'delete_task' obj.id %}"><button type="button" class="btn btn-danger">Delete</button></a></td>
                </tr>
            {% endif %}
       {% else %}
           {% if not obj.done %}
                <tr class="row">
                    <td class="col-5">{{ obj.task }}</td>
                    <td class="col-2">{{ obj.deadline }}</td>
                    <td class="col-1">{{ obj.importance }}</td>
                    <td class="col-2">
                        <a href="{% url 'complete_task' obj.id %}">
                            <button type="button" class="btn btn-dark">Mark this Completed</button>
                        </a>
                    </td>
                    <td class="col-1"><a href="{% url 'edit_task' obj.id %}"><button type="button" class="btn btn-warning">Edit</button></a></td>
                    <td class="col-1"><a href="{% url 'delete_task' obj.id %}"><button type="button" class="btn btn-danger">Delete</button></a></td>
                </tr>
            {% endif %}
       {% endif %}
    {% endfor %}
{% endif %}



  </tbody>
</table>
<nav aria-label="Page navigation example">
  <ul class="pagination justify-content-end">
    <li class="page-item"><a class="page-link" href="?pg=1"><<</a></li>
	{%if all_tasks.has_previous %}
		<li class="page-item"><a class="page-link" href="?pg={{ all_tasks.previous_page_number }}">{{ all_tasks.previous_page_number }}</a></li>
    {% endif %}
	<li class="page-item"><a class="page-link" href="?pg={{ all_tasks.number }}">{{ all_tasks.number }}</a></li>
	{%if all_tasks.has_next %}
		<li class="page-item"><a class="page-link" href="?pg={{ all_tasks.next_page_number }}">{{ all_tasks.next_page_number }}</a></li>
		<li class="page-item"><a class="page-link" href="?pg={{ all_tasks.next_page_number }}">{{ all_tasks.next_page_number }}</a></li>
    {% endif %}
	<li class="page-item"><a class="page-link" href="?pg={{ all_tasks.paginator.num_pages }}">>></a></li>
  </ul>
</nav>
</div>
{% endblock content %}